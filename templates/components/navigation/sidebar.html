{#
Componente: Sidebar (Barra Lateral de Navegación)
Uso: Navegación principal del sistema

Este componente se incluye automáticamente en el layout base
No requiere parámetros adicionales, usa el contexto global (user, request)
#}

{% load static %}

<aside class="sidebar" id="appSidebar">
    {# Logo y Header #}
    <div class="sidebar__header">
        <div class="sidebar__logo">
            <div class="sidebar__logo-icon">
                <i class="fas fa-cubes"></i>
            </div>
            <div class="sidebar__logo-text">
                <div class="sidebar__logo-title">KoreBase</div>
                <div class="sidebar__logo-subtitle">Enterprise ERP</div>
            </div>
        </div>
    </div>

    {# User Info #}
    <div class="sidebar__user">
        <div class="sidebar__user-avatar">
            {{ user.first_name.0|default:"U" }}{{ user.last_name.0|default:"" }}
        </div>
        <div class="sidebar__user-info">
            <div class="sidebar__user-name">{{ user.get_full_name|default:user.username }}</div>
            <div class="sidebar__user-role">{{ user.employee_id|default:"Empleado" }}</div>
        </div>
    </div>

    {# Navigation Menu #}
    <nav class="sidebar__nav">
        <a href="{% url 'core:dashboard' %}"
            class="sidebar__nav-item {% if request.resolver_match.url_name == 'dashboard' %}sidebar__nav-item--active{% endif %}">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
        </a>

        <a href="{% url 'logistica:index' %}"
            class="sidebar__nav-item {% if 'logistica' in request.path %}sidebar__nav-item--active{% endif %}">
            <i class="fas fa-boxes"></i>
            <span>Logística</span>
        </a>

        <a href="{% url 'produccion:index' %}"
            class="sidebar__nav-item {% if 'produccion' in request.path %}sidebar__nav-item--active{% endif %}">
            <i class="fas fa-industry"></i>
            <span>Producción</span>
        </a>

        <a href="{% url 'financiero:index' %}"
            class="sidebar__nav-item {% if 'financiero' in request.path %}sidebar__nav-item--active{% endif %}">
            <i class="fas fa-chart-line"></i>
            <span>Financiero</span>
        </a>

        {% if user.is_staff %}
        <div class="sidebar__divider"></div>

        <a href="/admin/" class="sidebar__nav-item">
            <i class="fas fa-cog"></i>
            <span>Administración</span>
        </a>
        {% endif %}
    </nav>

    {# Footer #}
    <div class="sidebar__footer">
        <a href="{% url 'core:logout' %}" class="sidebar__logout">
            <i class="fas fa-sign-out-alt"></i>
            <span>Cerrar Sesión</span>
        </a>
    </div>
</aside>

{# Overlay for mobile #}
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<style>
    /* ========================================
   SIDEBAR STYLES
   ======================================== */
    .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        width: var(--sidebar-width);
        background: linear-gradient(180deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
        color: var(--color-white);
        display: flex;
        flex-direction: column;
        z-index: var(--z-index-fixed);
        box-shadow: var(--shadow-xl);
        transition: transform var(--transition-base);
    }

    /* Header */
    .sidebar__header {
        padding: var(--spacing-6) var(--spacing-4);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar__logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
    }

    .sidebar__logo-icon {
        width: 48px;
        height: 48px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: var(--border-radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-size-2xl);
        color: var(--color-white);
    }

    .sidebar__logo-title {
        font-size: var(--font-size-xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-white);
    }

    .sidebar__logo-subtitle {
        font-size: var(--font-size-xs);
        color: rgba(255, 255, 255, 0.8);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    /* User Info */
    .sidebar__user {
        padding: var(--spacing-4);
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
        background: rgba(0, 0, 0, 0.1);
        margin: var(--spacing-4);
        border-radius: var(--border-radius-lg);
    }

    .sidebar__user-avatar {
        width: 40px;
        height: 40px;
        border-radius: var(--border-radius-full);
        background: rgba(255, 255, 255, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: var(--font-weight-bold);
        font-size: var(--font-size-sm);
        color: var(--color-white);
        flex-shrink: 0;
    }

    .sidebar__user-info {
        flex: 1;
        min-width: 0;
    }

    .sidebar__user-name {
        font-weight: var(--font-weight-semibold);
        font-size: var(--font-size-sm);
        color: var(--color-white);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .sidebar__user-role {
        font-size: var(--font-size-xs);
        color: rgba(255, 255, 255, 0.7);
    }

    /* Navigation */
    .sidebar__nav {
        flex: 1;
        padding: var(--spacing-2) var(--spacing-4);
        overflow-y: auto;
    }

    .sidebar__nav-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
        padding: var(--spacing-3) var(--spacing-4);
        margin-bottom: var(--spacing-1);
        border-radius: var(--border-radius-lg);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        transition: var(--transition-all);
    }

    .sidebar__nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-white);
    }

    .sidebar__nav-item--active {
        background: rgba(255, 255, 255, 0.15);
        color: var(--color-white);
        box-shadow: var(--shadow-sm);
    }

    .sidebar__nav-item i {
        width: 20px;
        text-align: center;
        font-size: var(--font-size-lg);
    }

    .sidebar__divider {
        height: 1px;
        background: rgba(255, 255, 255, 0.1);
        margin: var(--spacing-4) 0;
    }

    /* Footer */
    .sidebar__footer {
        padding: var(--spacing-4);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar__logout {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
        padding: var(--spacing-3) var(--spacing-4);
        border-radius: var(--border-radius-lg);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        transition: var(--transition-all);
    }

    .sidebar__logout:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-white);
    }

    .sidebar__logout i {
        width: 20px;
        text-align: center;
    }

    /* Overlay for mobile */
    .sidebar-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: calc(var(--z-index-fixed) - 1);
        opacity: 0;
        transition: opacity var(--transition-base);
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .sidebar {
            transform: translateX(-100%);
        }

        .sidebar.sidebar--open {
            transform: translateX(0);
        }

        .sidebar-overlay.sidebar-overlay--active {
            display: block;
            opacity: 1;
        }
    }

    /* Scrollbar styling */
    .sidebar__nav::-webkit-scrollbar {
        width: 6px;
    }

    .sidebar__nav::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-full);
    }

    .sidebar__nav::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: var(--border-radius-full);
    }

    .sidebar__nav::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.3);
    }
</style>

<script>
    // Toggle sidebar en móvil
    function toggleSidebar() {
        const sidebar = document.getElementById('appSidebar');
        const overlay = document.getElementById('sidebarOverlay');

        sidebar.classList.toggle('sidebar--open');
        overlay.classList.toggle('sidebar-overlay--active');
    }
</script>