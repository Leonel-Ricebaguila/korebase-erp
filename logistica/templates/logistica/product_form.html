{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}
{% block page_title %}{{ title }}{% endblock %}

{% block content %}
<style>
    .form-control {
        width: 100%;
        padding: 0.6rem 1rem;
        border: 1px solid var(--kore-gray-200);
        border-radius: var(--border-radius-md);
        background-color: white;
        font-size: 0.9rem;
        color: var(--kore-gray-800);
        margin-bottom: 0.5rem;
        /* Espacio para error o siguiente */
        display: block;
        box-sizing: border-box;
    }

    .form-control:focus {
        border-color: var(--kore-teal-500);
        outline: none;
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }

    label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--kore-navy-900);
        font-size: 0.85rem;
    }

    .field-wrapper {
        margin-bottom: 1.5rem;
    }

    .error-msg {
        color: #ef4444;
        font-size: 0.8rem;
        margin-top: 0.25rem;
    }
</style>

<div class="kore-card" style="max-width: 800px; margin: 0 auto; padding: 2rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h3 style="margin: 0; color: var(--kore-navy-900); font-size: 1.25rem;">Información del Producto</h3>
        <div style="font-size: 0.85rem; color: var(--kore-gray-500);">Complete los detalles para registrar un nuevo
            ítem.</div>
    </div>

    <form method="post">
        {% csrf_token %}

        <!-- Render manual para control total -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
            <div class="field-wrapper">
                <label for="{{ form.sku.id_for_label }}">SKU / Código *</label>
                {{ form.sku }}
                {% if form.sku.errors %}<div class="error-msg">{{ form.sku.errors.0 }}</div>{% endif %}
            </div>

            <div class="field-wrapper">
                <label for="{{ form.name.id_for_label }}">Nombre del Producto *</label>
                {{ form.name }}
                {% if form.name.errors %}<div class="error-msg">{{ form.name.errors.0 }}</div>{% endif %}
            </div>
        </div>

        <div class="field-wrapper">
            <label for="{{ form.description.id_for_label }}">Descripción</label>
            {{ form.description }}
            {% if form.description.errors %}<div class="error-msg">{{ form.description.errors.0 }}</div>{% endif %}
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
            <div class="field-wrapper">
                <label for="{{ form.category.id_for_label }}">Categoría</label>
                {{ form.category }}
                {% if form.category.errors %}<div class="error-msg">{{ form.category.errors.0 }}</div>{% endif %}
            </div>

            <div class="field-wrapper">
                <label for="{{ form.unit_cost.id_for_label }}">Costo Unitario ($)</label>
                {{ form.unit_cost }}
                {% if form.unit_cost.errors %}<div class="error-msg">{{ form.unit_cost.errors.0 }}</div>{% endif %}
            </div>
        </div>

        <div class="field-wrapper"
            style="display: flex; align-items: center; gap: 0.75rem; background: var(--kore-gray-50); padding: 1rem; border-radius: var(--border-radius-md);">
            {{ form.active }}
            <label for="{{ form.active.id_for_label }}" style="margin-bottom: 0; cursor: pointer;">Disponible en
                Inventario / Activo</label>
        </div>

        <div
            style="margin-top: 2rem; display: flex; gap: 1rem; padding-top: 1.5rem; border-top: 1px solid var(--kore-gray-100);">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Guardar Producto
            </button>
            <a href="{% url 'logistica:inventory_list' %}" class="btn btn-outline">
                Cancelar
            </a>
        </div>
    </form>
</div>

<script>
    // Script para estilizar los widgets de Django
    document.addEventListener('DOMContentLoaded', function () {
        const formCard = document.querySelector('.kore-card form');
        if (!formCard) return;
        const inputs = formCard.querySelectorAll('input[type="text"], input[type="number"], select, textarea');
        inputs.forEach(input => {
            input.classList.add('form-control');
        });

        // Ajuste específico para checkbox
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(chk => {
            chk.style.width = '1.25rem';
            chk.style.height = '1.25rem';
            chk.style.cursor = 'pointer';
            chk.style.accentColor = 'var(--kore-teal-500)';
        });
    });
</script>
{% endblock %}